set -e

echo "Building target webview"

SRC_DIR=deps/webview/webview
BUILD_DIR=$SRC_DIR/cmakebuild-unix
OUT_DIR=ninjabuild-unix

WEBVIEW_BUILD_FLAGS="-DWEBVIEW_BUILD_AMALGAMATION=OFF -DWEBVIEW_BUILD_DOCS=OFF -DWEBVIEW_BUILD_SHARED_LIBRARY=OFF -DWEBVIEW_BUILD_STATIC_LIBRARY=ON -DWEBVIEW_BUILD_TESTS=OFF -DWEBVIEW_INSTALL_TARGETS=OFF -DWEBVIEW_ENABLE_PACKAGING=OFF -DWEBVIEW_ENABLE_CLANG_TIDY=OFF -DWEBVIEW_ENABLE_CHECKS=OFF -DWEBVIEW_BUILD_EXAMPLES=OFF -DWEBVIEW_ENABLE_CLANG_FORMAT=OFF"
cmake -S $SRC_DIR -B $BUILD_DIR -G Ninja -DBUILD_MODULE=OFF -DBUILD_SHARED_LIBS=OFF -DBUILD_STATIC_LIBS=ON -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ $WEBVIEW_BUILD_FLAGS
cmake --build $BUILD_DIR --clean-first

cp $BUILD_DIR/core/libwebview.a $OUT_DIR
